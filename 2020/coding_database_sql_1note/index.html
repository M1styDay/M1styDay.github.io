<!DOCTYPE html>
<html lang="en-us">
  <link href="//use.fontawesome.com/releases/v5.9.0/css/all.css" rel="stylesheet">
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <script async src="https://cdn.splitbee.io/sb.js"></script>
  <script src="https://cdn.splitbee.io/sb-ab.js"></script>
  <meta name="author" content="M1sty">
  
  
  
  <link rel="prev" href="https://www.m1sty.com/2020/study-map_data-analysis/" />
  <link rel="next" href="https://www.m1sty.com/2020/coding_database_sql_2note/" />
  <link rel="canonical" href="https://www.m1sty.com/2020/coding_database_sql_1note/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           SQL必知必会笔记 | M1sty
       
  </title>
  <meta name="title" content="SQL必知必会笔记 | M1sty">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/www.m1sty.com"
    },
    "articleSection" : "posts",
    "name" : "SQL必知必会笔记",
    "headline" : "SQL必知必会笔记",
    "description" : "表操作 创建表 create table 表名（字段名称 字段类型 约束，……） 字符类型  character 字符串  char(size) 保存固定长度的字符串 varchar(n) 可变长度的字符_最多8000个字符 text 可变长度的字符串_最多2GB字符数据   unicode 字符串  nchar(n) 固定长度的Unicode数据_最多4000个字符 nvarchar(n) 可变长度的Unicode数据_最多4000个字符 ntext 可变长度的Unicode数据_最多2GB字符数据   Binary 类型  bit 允许0\/1\/null binary(n) 固定长度的二进制数据_\u0008最多8000字节 varbinary(n) 可变长度的二进制数据_最多8000字节 image 可变长度的二进制数据_最多2GB   Number 类型  tinyint 允许从0到255的所有数字 int 允许从-2,147,483,648到2,147,483,647的所有数字_占4字节 bigint -9,223,372,036,854,775,808到9,223,372,036,854,775,807范围内数字_占8字节 float 从-1.79E\u002b308到1.79E\u002b308的浮动精度数字数据 real 从-3.40E\u002b38到3.40E\u002b38的浮动精度数字数据 money 10进制货币数据   Date 类型  datetime 从1753年1月1日到9999年年12月31日，精度为3.33毫秒_8bytes date 仅储存日期。从0001年1月1日到9999年12月31日_3bytes   其他数据类型  uniqueidentifler 存储全局标识符（GUID） xml 存储XML格式化数据_最多2GB cursor 存储对用于数据库操作的指针的引用   常见的字符类型选择  字符类型建议采用varchar\/nvarchar数据类型 全额货币建议采用money数据类型 自增长标识建议采用bigint数据类型（int类型限制） 时间类型建议采用datetime数据类型 尽量不用text、ntext、image 尽量不用xml、varchar(max)、nvarchar(max)    不同数据库数据字符类型区别  https:\/\/www.",
    "inLanguage" : "en-us",
    "author" : "Misty",
    "creator" : "Misty",
    "publisher": "Misty",
    "accountablePerson" : "Misty",
    "copyrightHolder" : "Misty",
    "copyrightYear" : "2020",
    "datePublished": "2020-12-26 00:00:00 \u002b0000 UTC",
    "dateModified" : "2020-12-26 00:00:00 \u002b0000 UTC",
    "url" : "https:\/\/www.m1sty.com\/2020\/coding_database_sql_1note\/",
    "wordCount" : "556",
    "keywords" : [ "Database", "M1sty"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://www.m1sty.com">M1sty</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="About">About</a>
                
                <a class="menu-item" href="/links/" title="Links">Links</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://www.m1sty.com">M1sty</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="About">About</a>
                
                <a class="menu-item" href="/links/" title="Links">Links</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">SQL必知必会笔记</h1>
        <div class="post-meta">
        <i class="far fa-folder-open"></i>
            <span class="post-category"> in
                <a href="https://www.m1sty.com/categories/coding/"> Coding </a>
                    
            </span>
          <span class="post-time"> on
        <time datetime=2020-12-26 itemprop="datePublished">December 26, 2020</time>
           </span> (<span class="post-word-count">556 words)</span>
        </div>
    
    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title"></h2>
  
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#表操作">表操作</a>
      <ul>
        <li><a href="#创建表">创建表</a></li>
        <li><a href="#更新表">更新表</a></li>
        <li><a href="#查询表">查询表</a></li>
        <li><a href="#删除表">删除表</a></li>
      </ul>
    </li>
    <li><a href="#操作表中的数据">操作表中的数据</a>
      <ul>
        <li><a href="#增">增</a></li>
        <li><a href="#删">删</a></li>
        <li><a href="#改">改</a></li>
        <li><a href="#克隆表">克隆表</a></li>
      </ul>
    </li>
    <li><a href="#查询数据">查询数据</a>
      <ul>
        <li><a href="#select">select</a></li>
        <li><a href="#目标from">目标：from</a></li>
        <li><a href="#过滤where">过滤：where</a></li>
        <li><a href="#分组group-by">分组：group by</a></li>
        <li><a href="#排序order-by">排序：order by</a></li>
        <li><a href="#子查询">子查询</a></li>
        <li><a href="#组合查询union">组合查询：union</a></li>
        <li><a href="#集合函数">集合函数</a></li>
        <li><a href="#case-when">case when</a></li>
      </ul>
    </li>
    <li><a href="#其他">其他</a>
      <ul>
        <li><a href="#触发器">触发器</a></li>
        <li><a href="#事务">事务</a></li>
        <li><a href="#索引">索引</a></li>
        <li><a href="#视图">视图</a></li>
      </ul>
    </li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>
  </div>
</div>
<script type="text/javascript">
  window.onload = function () {
    var fix = $('.post-toc');
    var end = $('.post-comment');
    var fixTop = fix.offset().top, fixHeight = fix.height();
    var endTop, miss;
    var offsetTop = fix[0].offsetTop;
    $(window).scroll(function () {
      var docTop = Math.max(document.body.scrollTop, document.documentElement.scrollTop);
      if (end.length > 0) {
        endTop = end.offset().top;
        miss = endTop - docTop - fixHeight;
      }
      if (fixTop < docTop) {
        fix.css({ 'position': 'fixed' });
        if ((end.length > 0) && (endTop < (docTop + fixHeight))) {
          fix.css({ top: miss });
        } else {
          fix.css({ top: 0 });
        }
      } else {
        fix.css({ 'position': 'absolute' });
        fix.css({ top: offsetTop });
      }
    })
  }
</script> 
    
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <h2 id="表操作">表操作</h2>
<h3 id="创建表">创建表</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">create</span> <span style="color:#66d9ef">table</span> <span style="color:#960050;background-color:#1e0010">表名（字段名称</span> <span style="color:#960050;background-color:#1e0010">字段类型</span> <span style="color:#960050;background-color:#1e0010">约束，……）</span>
</code></pre></div><h5 id="字符类型">字符类型</h5>
<ul>
<li>character 字符串
<ul>
<li>char(size)  保存固定长度的字符串</li>
<li>varchar(n) 可变长度的字符_最多8000个字符</li>
<li>text 可变长度的字符串_最多2GB字符数据</li>
</ul>
</li>
<li>unicode 字符串
<ul>
<li>nchar(n) 固定长度的Unicode数据_最多4000个字符</li>
<li>nvarchar(n) 可变长度的Unicode数据_最多4000个字符</li>
<li>ntext 可变长度的Unicode数据_最多2GB字符数据</li>
</ul>
</li>
<li>Binary 类型
<ul>
<li>bit 允许0/1/null</li>
<li>binary(n) 固定长度的二进制数据_最多8000字节</li>
<li>varbinary(n) 可变长度的二进制数据_最多8000字节</li>
<li>image 可变长度的二进制数据_最多2GB</li>
</ul>
</li>
<li>Number 类型
<ul>
<li>tinyint 允许从0到255的所有数字</li>
<li>int 允许从-2,147,483,648到2,147,483,647的所有数字_占4字节</li>
<li>bigint -9,223,372,036,854,775,808到9,223,372,036,854,775,807范围内数字_占8字节</li>
<li>float 从-1.79E+308到1.79E+308的浮动精度数字数据</li>
<li>real 从-3.40E+38到3.40E+38的浮动精度数字数据</li>
<li>money 10进制货币数据</li>
</ul>
</li>
<li>Date 类型
<ul>
<li>datetime 从1753年1月1日到9999年年12月31日，精度为3.33毫秒_8bytes</li>
<li>date 仅储存日期。从0001年1月1日到9999年12月31日_3bytes</li>
</ul>
</li>
<li>其他数据类型
<ul>
<li>uniqueidentifler 存储全局标识符（GUID）</li>
<li>xml 存储XML格式化数据_最多2GB</li>
<li>cursor 存储对用于数据库操作的指针的引用</li>
</ul>
</li>
<li>常见的字符类型选择
<ul>
<li>字符类型建议采用varchar/nvarchar数据类型</li>
<li>全额货币建议采用money数据类型</li>
<li>自增长标识建议采用bigint数据类型（int类型限制）</li>
<li>时间类型建议采用datetime数据类型</li>
<li>尽量不用text、ntext、image</li>
<li>尽量不用xml、varchar(max)、nvarchar(max)</li>
</ul>
</li>
</ul>
<h5 id="不同数据库数据字符类型区别">不同数据库数据字符类型区别</h5>
<ul>
<li><a href="https://www.runoob.com/sql/sql-datatypes.html">https://www.runoob.com/sql/sql-datatypes.html</a></li>
</ul>
<h5 id="约束">约束</h5>
<ul>
<li>创建表时，对表进行限定，保证之后插入表的数据的完整性和正确性</li>
</ul>
<h5 id="约束种类">约束种类</h5>
<ul>
<li>primary key 主键
<ul>
<li>非空且唯一</li>
</ul>
</li>
<li>not null 非空</li>
<li>unique 唯一</li>
<li>autoincrement 主键且增长
<ul>
<li>当主键为integer型，可以自增长</li>
</ul>
</li>
<li>foreign key 外键
<ul>
<li>一张表的外键可以关联另外一张的主键，而保证数据的完整性</li>
</ul>
</li>
<li>check 约束用于限制列中的值的范围
<ul>
<li>如：check（age&gt;0)</li>
</ul>
</li>
<li>default 约束用于向列中插入默认值
<ul>
<li>如：city varchar(255) default &ldquo;Sandnes&rdquo;</li>
</ul>
</li>
</ul>
<h5 id="实例">实例</h5>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">create</span> tables student(
    id integer <span style="color:#66d9ef">primary</span> <span style="color:#66d9ef">key</span> autoincrement, <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">主键且自增长</span>
    name text <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">null</span>, <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">非空</span>
    age integer,
    gender text,
    email text <span style="color:#66d9ef">unique</span>, <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">唯一</span>
    <span style="color:#66d9ef">check</span>(age <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>)
    );
</code></pre></div><h3 id="更新表">更新表</h3>
<h4 id="增加列-add">增加列: add</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> stu <span style="color:#66d9ef">add</span> classname text;
</code></pre></div><h4 id="删除列-drop">删除列: drop</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> <span style="color:#66d9ef">table_name</span> <span style="color:#66d9ef">drop</span> <span style="color:#66d9ef">column</span> column_nameble;
</code></pre></div><h4 id="修改列类型-modify">修改列类型: modify</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> stu <span style="color:#66d9ef">modify</span> <span style="color:#66d9ef">column</span> gender text;
</code></pre></div><h4 id="修改列名-change">修改列名: change</h4>
<ul>
<li>字段类型不能丢，change不光能改列名也能修改类型</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> stu change <span style="color:#66d9ef">column</span> gender sex text
</code></pre></div><h4 id="修改表名-rename">修改表名: rename</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">alter</span> <span style="color:#66d9ef">table</span> stu <span style="color:#66d9ef">rename</span> <span style="color:#66d9ef">to</span> student
</code></pre></div><h3 id="查询表">查询表</h3>
<h4 id="show-tables">show tables</h4>
<ul>
<li>查询当前的数据库下的所有表名称</li>
</ul>
<h4 id="desc-表名">desc 表名</h4>
<ul>
<li>查询表的详细信息</li>
</ul>
<h3 id="删除表">删除表</h3>
<ul>
<li>drop table</li>
</ul>
<h2 id="操作表中的数据">操作表中的数据</h2>
<h3 id="增">增</h3>
<ul>
<li>insert into 表名（列名1，列名2……） values （&lsquo;值1&rsquo;，&lsquo;值2&rsquo;……）</li>
<li>如果是给所有的列增加数据，则列名可以省略</li>
</ul>
<h3 id="删">删</h3>
<ul>
<li>delete from 表名 [where 条件]</li>
<li>如果不加条件，则将表中的数据全部删除</li>
<li>删除所有行 truncate table</li>
</ul>
<h3 id="改">改</h3>
<ul>
<li>update 表名 set 列名= 值， 列2=值2，……[where 条件]</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">update</span> scores <span style="color:#66d9ef">set</span> scores <span style="color:#f92672">=</span> scores<span style="color:#f92672">+</span><span style="color:#ae81ff">5</span> <span style="color:#66d9ef">where</span> scores <span style="color:#f92672">&lt;=</span><span style="color:#ae81ff">95</span>
</code></pre></div><h3 id="克隆表">克隆表</h3>
<p>参考<a href="https://www.m1sty.com/2020/database_sql_sentences/">review</a>中的例子</p>
<h2 id="查询数据">查询数据</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">SELECT</span> selection_list    <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">要查询的列名称</span>
    <span style="color:#66d9ef">From</span> table_list               <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">要查询的表名称</span>
    <span style="color:#66d9ef">WHERE</span> condition          <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">行条件</span>
    <span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> grouping_columns       <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">对结果分组</span>
    <span style="color:#66d9ef">HAVING</span> condition                           <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">分组后的条件</span>
    <span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> sorting_columns         <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">对结果分组</span>
    <span style="color:#66d9ef">LIMIT</span> offset_start, <span style="color:#66d9ef">row_count</span>      <span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">结果限定</span>
</code></pre></div><h3 id="select">select</h3>
<h4 id="通配符号-">通配符号 *</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">table</span>
</code></pre></div><h4 id="别名-as">别名 as</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#66d9ef">column_name</span> <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">table_name</span> <span style="color:#66d9ef">AS</span> name;
</code></pre></div><h4 id="拼接-concat">拼接 concat()</h4>
<p>函数使用说明：返回不同的非NULL 值数目。若找不到匹配的项，则COUNT(DISTINCT) 返回 0</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> concat(<span style="color:#e6db74">&#39;工号为:&#39;</span><span style="color:#960050;background-color:#1e0010">，</span>FNumber<span style="color:#960050;background-color:#1e0010">，</span><span style="color:#e6db74">&#39;的员工的幸福指数:&#39;</span><span style="color:#960050;background-color:#1e0010">，</span>FSalary<span style="color:#f92672">/</span>(FAge<span style="color:#f92672">-</span><span style="color:#ae81ff">21</span>))
<span style="color:#66d9ef">select</span> concat_ws(<span style="color:#e6db74">&#39;:&#39;</span>,<span style="color:#e6db74">&#39;1&#39;</span>,<span style="color:#e6db74">&#39;2&#39;</span>,<span style="color:#e6db74">&#39;3&#39;</span>) <span style="color:#66d9ef">from</span> test ; 
</code></pre></div><h4 id="去除重复的记录-distinct">去除重复的记录 distinct</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#66d9ef">distinct</span> <span style="color:#66d9ef">column_name</span>, <span style="color:#66d9ef">column_name</span> <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">table_name</span>
</code></pre></div><h3 id="目标from">目标：from</h3>
<h4 id="连接-join">连接 join</h4>
<p><strong>简单连接 inner join：如果表中有至少一个匹配，则返回行</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">column_name</span>(s)
    <span style="color:#66d9ef">from</span> table1
    <span style="color:#66d9ef">inner</span> <span style="color:#66d9ef">join</span> table2
    <span style="color:#66d9ef">on</span> table1.<span style="color:#66d9ef">column_name</span> <span style="color:#f92672">=</span> table2.<span style="color:#66d9ef">column_name</span>;
</code></pre></div><p><strong>全连接 full outer join：返回左右表中的所有记录</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> <span style="color:#66d9ef">column_name</span>(s)
    <span style="color:#66d9ef">from</span> table1
    <span style="color:#66d9ef">full</span> <span style="color:#66d9ef">outer</span> <span style="color:#66d9ef">join</span> table2
    <span style="color:#66d9ef">on</span> table1.<span style="color:#66d9ef">column_name</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">table</span>.<span style="color:#66d9ef">column_name</span>;
</code></pre></div><p><strong>左连接 left join：如果表中有至少一个匹配，则返回行</strong></p>
<ul>
<li>left join关键字从左表（table1）返回所有的行，即使右表（table2）中没有匹配。如果右表中没有匹配，则结果为null。</li>
</ul>
<p> </p>
<p><strong>右连接 right join：即使左表中没有匹配，也从右表返回所有的行</strong></p>
<ul>
<li>right join关键字从右表（table2）返回所有的行，即使左表（table1）中没有匹配。如果左表中没有匹配，则结果为null。</li>
</ul>
<h3 id="过滤where">过滤：where</h3>
<ul>
<li>=、！=、&lt;&gt;、&lt;、&lt;=、&gt;、&gt;=</li>
<li>between&hellip; and：&gt;= 且 &lt;=</li>
<li>is null：判断是否为null</li>
<li>in(set)：在某一集合内</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> emp <span style="color:#66d9ef">where</span> sal <span style="color:#66d9ef">in</span> (<span style="color:#ae81ff">5000</span>,<span style="color:#ae81ff">2000</span>,<span style="color:#ae81ff">1500</span>);
</code></pre></div><ul>
<li>and</li>
<li>or</li>
<li>not</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> emp <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">not</span> sal <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1500</span>
</code></pre></div><ul>
<li>like</li>
</ul>
<ol>
<li>任意字符 %</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">选取</span>name以<span style="color:#960050;background-color:#1e0010">“</span><span style="color:#66d9ef">G</span><span style="color:#960050;background-color:#1e0010">”开头的所有客户</span>
<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> websites <span style="color:#66d9ef">where</span> name <span style="color:#66d9ef">like</span> <span style="color:#e6db74">&#39;G%&#39;</span><span style="color:#960050;background-color:#1e0010">；</span>
</code></pre></div><ol start="2">
<li>单个字符 _</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#f92672">#</span><span style="color:#960050;background-color:#1e0010">选取</span>name以<span style="color:#960050;background-color:#1e0010">“</span><span style="color:#66d9ef">G</span><span style="color:#960050;background-color:#1e0010">”开始，然后是一个任意字符，然后是“</span>o<span style="color:#960050;background-color:#1e0010">”，然后是一个任意字符，然后是“</span>le<span style="color:#960050;background-color:#1e0010">”的</span>
<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> website <span style="color:#66d9ef">where</span> name <span style="color:#66d9ef">like</span> <span style="color:#e6db74">&#39;G_o_le&#39;</span>
</code></pre></div><ol start="3">
<li>字符集 [charlist] / 不在字符列中的任何单一字符 [^charlist]</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> websites <span style="color:#66d9ef">where</span> name regexp <span style="color:#e6db74">&#39;^[A-H]&#39;</span>
</code></pre></div><h3 id="分组group-by">分组：group by</h3>
<ul>
<li>用于结合合计函数，根据一个或多个列对结果进行分组</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#66d9ef">column_name</span>, <span style="color:#66d9ef">function</span>(<span style="color:#66d9ef">column_name</span>) <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">table_name</span> <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">column_name</span>;
</code></pre></div><ul>
<li>having对分组之后的数据进行筛选</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> deptno, <span style="color:#66d9ef">AVG</span>(sal) <span style="color:#66d9ef">from</span> emp
    <span style="color:#66d9ef">where</span> sal <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1200</span>
    <span style="color:#66d9ef">group</span> <span style="color:#66d9ef">by</span> deptno
    <span style="color:#66d9ef">having</span> <span style="color:#66d9ef">AVG</span>(sal) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2200</span>
</code></pre></div><h3 id="排序order-by">排序：order by</h3>
<ul>
<li>语句用于根据指定的列对结果集进行排序</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">order</span> <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">column_name</span> <span style="color:#66d9ef">ASC</span><span style="color:#f92672">|</span><span style="color:#66d9ef">DESC</span>;
</code></pre></div><ul>
<li>返回结果限定：limit</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">limit</span> m <span style="color:#66d9ef">offset</span> n<span style="color:#960050;background-color:#1e0010">，从第</span>n行开始往后的m行
</code></pre></div><h3 id="子查询">子查询</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span>
<span style="color:#66d9ef">from</span> customers
<span style="color:#66d9ef">where</span> id <span style="color:#66d9ef">in</span> <span style="color:#960050;background-color:#1e0010">（</span><span style="color:#66d9ef">select</span> id <span style="color:#66d9ef">from</span> customers <span style="color:#66d9ef">where</span> salary <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">4500</span>)
</code></pre></div><h3 id="组合查询union">组合查询：union</h3>
<p>合并两个或多个select语句的结果</p>
<ul>
<li>使用规则</li>
</ul>
<p>union必须由两条或两条以上select语句组成，语句之间用union分隔</p>
<p>union中的每个查询必须包含相同的列、表达式或聚集函数</p>
<p>列数据类型必须兼容：类型不必完全相同，但必须是DBMS可以隐含转换的类型（例如，不同的数值类型或不同的日期类型）</p>
<ul>
<li>使用场景</li>
</ul>
<p>在一个查询中从不同的表返回结构数据</p>
<p>对一个表执行多个查询，按一个查询返回数据</p>
<ul>
<li>语法</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> cus_name, cus_contact, cus_email
    <span style="color:#66d9ef">from</span> customers
    <span style="color:#66d9ef">where</span> cus_state <span style="color:#66d9ef">IN</span> (<span style="color:#e6db74">&#39;IL&#39;</span>, <span style="color:#e6db74">&#39;IN&#39;</span>, <span style="color:#e6db74">&#39;MI&#39;</span>)
    <span style="color:#66d9ef">union</span>
    <span style="color:#66d9ef">select</span> cus_name, cus_contact, cus_email
    <span style="color:#66d9ef">from</span> customers
    <span style="color:#66d9ef">where</span> cus_name <span style="color:#66d9ef">IN</span> (<span style="color:#e6db74">&#39;111&#34;);
</span></code></pre></div><ul>
<li>union all union（union只会选取结果中不同的值，用union all可选择选取重复的值）</li>
<li>union和union all的区别是,union会自动压缩多个结果集合中的重复结果，而union all则将所有的结果全部显示出来，不管是不是重复。
<ul>
<li>*Union：对两个结果集进行并集操作，不包括重复行，同时进行默认规则的排序；*Union在进行表链接后会筛选掉重复的记录，所以在表链接后会对所产生的结果集进行排序运算，删除重复的记录再返回结果。实际大部分应用中是不会产生重复的记录，最常见的是过程表与历史表UNION。</li>
<li>*Union All：对两个结果集进行并集操作，包括重复行，不进行排序；*如果返回的两个结果集中有重复的数据，那么返回的结果集就会包含重复的数据了。</li>
</ul>
</li>
</ul>
<h3 id="集合函数">集合函数</h3>
<ul>
<li>aggregate函数：计算从列中取得的值，返回一个单一的值</li>
</ul>
<p>AVG()</p>
<p>COUNT()</p>
<p>FIRST()</p>
<p>LAST()</p>
<p>MIN()</p>
<p>SUM()</p>
<ul>
<li>sql scalar函数:基于输入值，返回一个单一的值</li>
</ul>
<p>UCASE():将某个字段转换为大写</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> ucase(<span style="color:#66d9ef">column_name</span>) <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">table_name</span> 
    <span style="color:#66d9ef">select</span> ucase(name) <span style="color:#66d9ef">as</span> site_title, url <span style="color:#66d9ef">from</span> websites
</code></pre></div><p>LCASE(): 将某个字段转换为小写</p>
<p>MID():从某个文本字段提取字符</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> mid(colunm_name, <span style="color:#66d9ef">start</span>[,<span style="color:#66d9ef">length</span>]) <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">table_name</span>
</code></pre></div><p>LEN():返回某个文本字段的长度</p>
<p>ROUND():对某个数值字段进行指定小数位数的四舍五入</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> round(<span style="color:#66d9ef">column_name</span>, decimals) <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">table_name</span>
</code></pre></div><p>NOW():返回当前的系统日期和时间</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">select</span> name, url, now() <span style="color:#66d9ef">as</span> date <span style="color:#66d9ef">from</span> websites;
</code></pre></div><p>FORMAT():格式化某个字段的显示方式</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">select</span> format(<span style="color:#66d9ef">column_name</span>, format) <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">table_name</span>;
</code></pre></div><h3 id="case-when">case when</h3>
<p>参考<a href="https://www.m1sty.com/2020/database_sql_50/">习题</a>中的例子</p>
<h2 id="其他">其他</h2>
<h3 id="触发器">触发器</h3>
<h3 id="事务">事务</h3>
<h3 id="索引">索引</h3>
<h3 id="视图">视图</h3>
<ul>
<li>索引：索引是对数据库表中一列或多列的值进行排序的一种结构，使用索引可快速访问数据库表中的特定信息。如果想按特定职员的姓来查找他或她，则与在表中搜索所有的行相比，索引有助于更快地获取信息。索引分为聚簇索引和非聚簇索引两种，聚簇索引是按照数据存放的物理位置为顺序的，而非聚簇索引就不一样了；聚簇索引能提高多行检索的速度，而非聚簇索引对于单行的检索很快。根据数据库的功能，可以在数据库设计器中创建三种索引：唯一索引、主键索引和聚集索引。
<ul>
<li>唯一索引：唯一索引是不允许其中任何两行具有相同索引值的索引。当现有数据中存在重复的键值时，大多数数据库不允许将新创建的唯一索引与表一起保存。数据库还可能防止添加将在表中创建重复键值的新数据。例如，如果在employee表中职员的姓(lname)上创建了唯一索引，则任何两个员工都不能同姓。</li>
<li>主键索引：数据库表经常有一列或多列组合，其值唯一标识表中的每一行。该列称为表的主键。在数据库关系图中为表定义主键将自动创建主键索引，主键索引是唯一索引的特定类型。该索引要求主键中的每个值都唯一。当在查询中使用主键索引时，它还允许对数据的快速访问。</li>
<li>聚集索引：在聚集索引中，表中行的物理顺序与键值的逻辑（索引）顺序相同。一个表只能包含一个聚集索引。如果某索引不是聚集索引，则表中行的物理顺序与键值的逻辑顺序不匹配。与非聚集索引相比，聚集索引通常提供更快的数据访问速度。聚集索引和非聚集索引的区别，如字典默认按字母顺序排序，读者如知道某个字的读音可根据字母顺序快速定位。因此聚集索引和表的内容是在一起的。如读者需查询某个生僻字，则需按字典前面的索引，举例按偏旁进行定位，找到该字对应的页数，再打开对应页数找到该字。这种通过两个地方而查询到某个字的方式就如非聚集索引。</li>
</ul>
</li>
</ul>
<p> </p>
<hr>
<p> </p>
<h2 id="reference">Reference</h2>
<table>
<thead>
<tr>
<th style="text-align:center">Name</th>
<th style="text-align:center">Link</th>
<th style="text-align:center">Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">《SQL必知必会》</td>
<td style="text-align:center">Null</td>
<td style="text-align:center">Null</td>
</tr>
</tbody>
</table>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>M1sty </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://www.m1sty.com/2020/coding_database_sql_1note/>https://www.m1sty.com/2020/coding_database_sql_1note/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://www.m1sty.com/tags/database/">
                    #Database</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://www.m1sty.com">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://www.m1sty.com/2020/study-map_data-analysis/" class="prev" rel="prev" title="数据分析学习路径"><i class="iconfont icon-left"></i>&nbsp;数据分析学习路径</a>
         
        
        <a href="https://www.m1sty.com/2020/coding_database_sql_2note/" class="next" rel="next" title="SQL复习笔记">SQL复习笔记&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2020 - 2021</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://www.m1sty.com">M1sty</a> | </span> 
         

         
		  <span> <a href="https://www.m1sty.com" target="_blank" rel="external nofollow">Data Analyst</a> => <a href="https://www.m1sty.com" target="_blank" rel="external nofollow">Data Scientist</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  




<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\[','\]']],
            processEscapes: true,
            processEnvironments: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            TeX: {
                equationNumbers: { autoNumber: "AMS" },
                extensions: ["AMSmath.js", "AMSsymbols.js"]
            }
        }
    });
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
     </div>
  </body>
</html>
