<!DOCTYPE html>
<html lang="en-us">
  <link href="//use.fontawesome.com/releases/v5.9.0/css/all.css" rel="stylesheet">
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="M1sty">
  
  
  
  <link rel="prev" href="https://www.m1sty.com/2020/database_sql_notes/" />
  <link rel="next" href="https://www.m1sty.com/2020/database_sql_50/" />
  <link rel="canonical" href="https://www.m1sty.com/2020/database_sql_sentences/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           SQL语句复习 | M1sty
       
  </title>
  <meta name="title" content="SQL语句复习 | M1sty">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/www.m1sty.com"
    },
    "articleSection" : "posts",
    "name" : "SQL语句复习",
    "headline" : "SQL语句复习",
    "description" : "DDL \u0026amp; DML 库操作 创建数据库 CREATE DATABASE database-name\n删除数据库 drop database dbname\n分离数据库 sp_detach_db\n附加数据库 sp_attach_db （后接表明，附加需要完整的路径名）\n修改数据库名称 sp_renamedb \u0026lsquo;old_name\u0026rsquo;, \u0026lsquo;new_name\u0026rsquo;\n表操作 创建新表 create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..)\n根据已有的表创建新表 A：create table tab_new like tab_old\nB：create table tab_new as select col1,col2… from tab_old definition only\n删除表 drop table tabname\n增加列 Alter table tabname add column col type\n添加\/删除主键 Alter table tabname add primary key(col)\nAlter table tabname drop primary key(col)",
    "inLanguage" : "en-us",
    "author" : "Misty",
    "creator" : "Misty",
    "publisher": "Misty",
    "accountablePerson" : "Misty",
    "copyrightHolder" : "Misty",
    "copyrightYear" : "2020",
    "datePublished": "2020-12-28 00:00:00 \u002b0000 UTC",
    "dateModified" : "2020-12-28 00:00:00 \u002b0000 UTC",
    "url" : "https:\/\/www.m1sty.com\/2020\/database_sql_sentences\/",
    "wordCount" : "596",
    "keywords" : [ "sql", "M1sty"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://www.m1sty.com">M1sty</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="About">About</a>
                
                <a class="menu-item" href="/links/" title="Links">Links</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://www.m1sty.com">M1sty</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="About">About</a>
                
                <a class="menu-item" href="/links/" title="Links">Links</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">SQL语句复习</h1>
        <div class="post-meta">
        <i class="far fa-folder-open"></i>
            <span class="post-category"> in
                <a href="https://www.m1sty.com/categories/database/"> Database </a>
                    
            </span>
          <span class="post-time"> on
        <time datetime=2020-12-28 itemprop="datePublished">December 28, 2020</time>
           </span> (<span class="post-word-count">596 words)</span>
        </div>
    
    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title"></h2>
  
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#ddl--dml">DDL &amp; DML</a>
      <ul>
        <li><a href="#库操作">库操作</a></li>
        <li><a href="#表操作">表操作</a></li>
        <li><a href="#update--alter">update &amp; alter</a></li>
        <li><a href="#insertcreate--deletedrop">insert/create &amp; delete/drop</a></li>
      </ul>
    </li>
    <li><a href="#dql">DQL</a>
      <ul>
        <li><a href="#基础语法">基础语法</a></li>
        <li><a href="#高级查询运算词">高级查询运算词</a></li>
        <li><a href="#外连接">外连接</a></li>
        <li><a href="#分组group-by">分组（Group By）</a></li>
      </ul>
    </li>
    <li><a href="#提升应用">提升应用</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#reference">Reference</a></li>
  </ul>
</nav>
  </div>
</div>
<script type="text/javascript">
  window.onload = function () {
    var fix = $('.post-toc');
    var end = $('.post-comment');
    var fixTop = fix.offset().top, fixHeight = fix.height();
    var endTop, miss;
    var offsetTop = fix[0].offsetTop;
    $(window).scroll(function () {
      var docTop = Math.max(document.body.scrollTop, document.documentElement.scrollTop);
      if (end.length > 0) {
        endTop = end.offset().top;
        miss = endTop - docTop - fixHeight;
      }
      if (fixTop < docTop) {
        fix.css({ 'position': 'fixed' });
        if ((end.length > 0) && (endTop < (docTop + fixHeight))) {
          fix.css({ top: miss });
        } else {
          fix.css({ top: 0 });
        }
      } else {
        fix.css({ 'position': 'absolute' });
        fix.css({ top: offsetTop });
      }
    })
  }
</script> 
    
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <h2 id="ddl--dml">DDL &amp; DML</h2>
<h3 id="库操作">库操作</h3>
<h4 id="创建数据库">创建数据库</h4>
<p>CREATE DATABASE database-name</p>
<h4 id="删除数据库">删除数据库</h4>
<p>drop database dbname</p>
<h4 id="分离数据库">分离数据库</h4>
<p>sp_detach_db</p>
<h4 id="附加数据库">附加数据库</h4>
<p>sp_attach_db （后接表明，附加需要完整的路径名）</p>
<h4 id="修改数据库名称">修改数据库名称</h4>
<p>sp_renamedb &lsquo;old_name&rsquo;, &lsquo;new_name&rsquo;</p>
<h3 id="表操作">表操作</h3>
<h4 id="创建新表">创建新表</h4>
<p>create table tabname(col1 type1 [not null] [primary key],col2 type2 [not null],..)</p>
<h4 id="根据已有的表创建新表">根据已有的表创建新表</h4>
<p>A：create table tab_new like tab_old</p>
<p>B：create table tab_new as select col1,col2… from tab_old definition only</p>
<h4 id="删除表">删除表</h4>
<p>drop table tabname</p>
<h4 id="增加列">增加列</h4>
<p>Alter table tabname add column col type</p>
<h4 id="添加删除主键">添加/删除主键</h4>
<p>Alter table tabname add primary key(col)</p>
<p>Alter table tabname drop primary key(col)</p>
<h4 id="创建删除索引索引不可更改想要改必须删除重新建">创建/删除索引（索引不可更改，想要改必须删除重新建）</h4>
<p>create [unique] index idxname on tabname(col….)</p>
<p>drop index idxname</p>
<h4 id="创建删除视图">创建/删除视图</h4>
<p>create view viewname as select statement</p>
<p>drop view viewname</p>
<h3 id="update--alter">update &amp; alter</h3>
<h4 id="update-语句可用来修改表中的数据">update 语句可用来修改表中的数据</h4>
<p>update 表名称 set 列名称=新值 where 更新条件</p>
<h4 id="alter-语句可用来修改数据表名或修改数据表字段">Alter 语句可用来修改数据表名或修改数据表字段</h4>
<p>add/drop/change/modify/set default/rename</p>
<h3 id="insertcreate--deletedrop">insert/create &amp; delete/drop</h3>
<p>区别用法</p>
<hr>
<h2 id="dql">DQL</h2>
<h3 id="基础语法">基础语法</h3>
<p>选择：select * from table1 where 范围</p>
<p>插入：insert into table1(field1,field2) values(value1,value2)</p>
<p>删除：delete from table1 where</p>
<p>范围更新：update table1 set field1=value1 where 范围</p>
<p>查找：select * from table1 where field1 like ’%value1%’</p>
<p>排序：select * from table1 order by field1,field2 [desc]</p>
<p>总数：select count as totalcount from table1</p>
<p>求和：select sum(field1) as sumvalue from table1</p>
<p>平均：select avg(field1) as avgvalue from table1</p>
<p>最大：select max(field1) as maxvalue from table1</p>
<p>最小：select min(field1) as minvalue from table1</p>
<h3 id="高级查询运算词">高级查询运算词</h3>
<p>A：UNION 运算符</p>
<p>UNION 运算符通过组合其他两个结果表（例如 TABLE1 和 TABLE2）并消去表中任何重复行而派生出一个结果表。当 ALL 随 UNION 一起使用时（即 UNION ALL），不消除重复行。两种情况下，派生表的每一行不是来自 TABLE1 就是来自 TABLE2。</p>
<p>B：EXCEPT 运算符</p>
<p>EXCEPT运算符通过包括所有在 TABLE1 中但不在 TABLE2 中的行并消除所有重复行而派生出一个结果表。当 ALL 随 EXCEPT 一起使用时 (EXCEPT ALL)，不消除重复行。</p>
<p>C：INTERSECT 运算符</p>
<p>INTERSECT运算符通过只包括 TABLE1 和 TABLE2 中都有的行并消除所有重复行而派生出一个结果表。当 ALL随 INTERSECT 一起使用时 (INTERSECT ALL)，不消除重复行。
注：使用运算词的几个查询结果行必须是一致的。</p>
<h3 id="外连接">外连接</h3>
<p>A：left （outer） join</p>
<p>左外连接（左连接）：结果集几包括连接表的匹配行，也包括左连接表的所有行。
SQL: select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p>
<p>B：right （outer） join</p>
<p>右外连接(右连接)：结果集既包括连接表的匹配连接行，也包括右连接表的所有行。</p>
<p>C：full/cross （outer） join</p>
<p>全外连接：不仅包括符号连接表的匹配行，还包括两个连接表中的所有记录。</p>
<h3 id="分组group-by">分组（Group By）</h3>
<p>一张表，一旦分组 完成后，查询后只能得到组相关的信息。</p>
<p>组相关的信息：（统计信息） count,sum,max,min,avg  分组的标准)</p>
<p>Group by + having</p>
<hr>
<h2 id="提升应用">提升应用</h2>
<h4 id="复制表只复制结构源表名a-新表名b">复制表(只复制结构,源表名：a 新表名：b)</h4>
<p>select top 0 * into b from a</p>
<h4 id="拷贝表拷贝数据源表名a-目标表名b">拷贝表(拷贝数据,源表名：a 目标表名：b)</h4>
<p>insert into b(a, b, c) select d,e,f from b</p>
<h4 id="跨数据库之间表的拷贝具体数据使用绝对路径">跨数据库之间表的拷贝(具体数据使用绝对路径)</h4>
<p>insert into b(a, b, c) select d,e,f from b in ‘具体数据库’ where 条件</p>
<p>例子：..from b in &lsquo;&quot;&amp;Server.MapPath(&quot;.&quot;)&amp;&quot;\data.mdb&quot; &amp;&quot;&rsquo; where..</p>
<h4 id="子查询表名1a-表名2b">子查询(表名1：a 表名2：b)</h4>
<p>select a,b,c from a where a IN (select d from b ) 或者: select a,b,c from a where a IN (1,2,3)</p>
<h4 id="显示文章提交人和最后回复时间">显示文章、提交人和最后回复时间</h4>
<p>select a.title,a.username,b.adddate from table a,(select max(adddate) adddate from table where table.title=a.title) b</p>
<h4 id="外连接查询">外连接查询</h4>
<p>select a.a, a.b, a.c, b.c, b.d, b.f from a LEFT OUT JOIN b ON a.a = b.c</p>
<h4 id="在线视图查询">在线视图查询</h4>
<p>select * from (SELECT a,b,c FROM a) T where t.a &gt; 1;</p>
<h4 id="between的用法between限制查询数据范围时包括了边界值not-between不包括">between的用法：between限制查询数据范围时包括了边界值,not between不包括</h4>
<p>select * from table1 where time between time1 and time2</p>
<p>select a,b,c, from table1 where a not between 数值1 and 数值2</p>
<h4 id="in-的使用方法">in 的使用方法</h4>
<p>select * from table1 where a [not] in (‘值1’,’值2’,’值4’,’值6’)</p>
<h4 id="两张关联表删除主表中已经在副表中没有的信息">两张关联表，删除主表中已经在副表中没有的信息</h4>
<p>delete from table1 where not exists ( select * from table2 where table1.field1=table2.field1 )</p>
<h4 id="四表联查问题">四表联查问题</h4>
<p>select * from a left inner join b on a.a=b.b right inner join c on a.a=c.c inner join d on a.a=d.d where &hellip;..</p>
<h4 id="日常安排提前五分钟提醒">日常安排提前五分钟提醒</h4>
<p>select * from 日程安排 where datediff(&lsquo;minute&rsquo;,f开始时间,getdate())&gt;5</p>
<h4 id="数据库分页">数据库分页</h4>
<p>select top 10 b.*</p>
<p>from (select top 20 主键字段,排序字段 from 表名 order by 排序字段 desc) a,表名 b</p>
<p>where b.主键字段 = a.主键字段</p>
<p>order by a.排序字段</p>
<h4 id="前10条记录">前10条记录</h4>
<p>select top 10 * form table1 where 范围</p>
<h4 id="选择在每一组b值相同的数据中对应的a最大的记录的所有信息类似这样的用法可以用于论坛每月排行榜每月热销产品分析按科目成绩排名等等">选择在每一组b值相同的数据中对应的a最大的记录的所有信息(类似这样的用法可以用于论坛每月排行榜,每月热销产品分析,按科目成绩排名,等等。)</h4>
<p>select a,b,c from tablename ta where a=(select max(a) from tablename tb where tb.b=ta.b)</p>
<h4 id="包括所有在tablea中但不在tableb和tablec中的行并消除所有重复行而派生出一个结果表">包括所有在TableA中、但不在TableB和TableC中的行并消除所有重复行而派生出一个结果表</h4>
<p>(select a from tableA ) except (select a from tableB) except (select a from tableC)</p>
<h4 id="随机取出10条数据">随机取出10条数据</h4>
<p>select top 10 * from tablename order by newid()</p>
<h4 id="随机选择记录">随机选择记录</h4>
<p>select newid()</p>
<h4 id="删除重复记录">删除重复记录</h4>
<p>delete from tablename where id not in (select max(id) from tablename group by col1,col2,&hellip;)</p>
<h4 id="列出数据库里所有的表名">列出数据库里所有的表名</h4>
<p>select name from sysobjects where type=&lsquo;U&rsquo; // U代表用户</p>
<h4 id="列出表里的所有的列名">列出表里的所有的列名</h4>
<p>select name from syscolumns where id=object_id(&lsquo;TableName&rsquo;)</p>
<h4 id="初始化表table1">初始化表table1</h4>
<p>TRUNCATE TABLE table1</p>
<h4 id="选择从10到15的记录">选择从10到15的记录</h4>
<p>select top 5 * from (select top 15 * from table order by id asc) table_别名 order by id desc</p>
<p> </p>
<hr>
<p> </p>
<h2 id="reference">Reference</h2>
<table>
<thead>
<tr>
<th style="text-align:center">Name</th>
<th style="text-align:center">Link</th>
<th style="text-align:center">Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">小蚊子数据分析</td>
<td style="text-align:center"><a href="https://mp.weixin.qq.com/s/by_ZOQvLFTtpd7ciGh1b9w">1500字sql语句大全</a></td>
<td style="text-align:center">前半篇</td>
</tr>
</tbody>
</table>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>M1sty </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://www.m1sty.com/2020/database_sql_sentences/>https://www.m1sty.com/2020/database_sql_sentences/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://www.m1sty.com/tags/sql/">
                    #sql</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://www.m1sty.com">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://www.m1sty.com/2020/database_sql_notes/" class="prev" rel="prev" title="SQL基础知识"><i class="iconfont icon-left"></i>&nbsp;SQL基础知识</a>
         
        
        <a href="https://www.m1sty.com/2020/database_sql_50/" class="next" rel="next" title="SQL面试必会50题_题解">SQL面试必会50题_题解&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2020 - 2021</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://www.m1sty.com">M1sty</a> | </span> 
         

         
		  <span> <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Data Analyst</a> => <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">Data Scientist</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
